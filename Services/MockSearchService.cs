using GooruuSearchApp.Models;

namespace GooruuSearchApp.Services
{
    public class MockSearchService
    {
        // เก็บข้อมูลไว้ในตัวแปร private เพื่อให้ Search และ GetArticle ใช้ข้อมูลชุดเดียวกัน
        private readonly List<SearchResult> _allResults;

        public MockSearchService()
        {
            _allResults = new List<SearchResult>
            {
                // ข่าวที่ 1: ศพในคฤหาสน์
                new SearchResult
                {
                    Id = "case-mansion-001",
                    Title = "ด่วน! พบศพปริศนาในคฤหาสน์ร้างย่านชานเมือง สภาพสุดสยอง",
                    Url = "https://www.dailynews-mock.com/crime/body-found-mansion",
                    Snippet = "ตำรวจเร่งตรวจสอบพื้นที่หลังได้รับแจ้งเหตุพบศพชายไม่ทราบชื่อ... สภาพศพมีร่องรอยการถูกทำร้ายและสัญลักษณ์ประหลาด...",
                    Date = "2 ชั่วโมงที่แล้ว",
                    ImageUrl = "https://images.unsplash.com/photo-1504194784405-d6d79075c3a3?q=80&w=800&auto=format&fit=crop", // รูปบ้านเก่าๆ
                    FullContent = @"
                        <p><b>(รายงานพิเศษ)</b> - เมื่อเวลา 02.30 น. ของวันนี้ เจ้าหน้าที่ตำรวจ สภ.เมือง ได้รับแจ้งจากชาวบ้านละแวกใกล้เคียงว่ามีกลิ่นเหม็นเน่ารุนแรงโชยออกมาจากคฤหาสน์เก่าสมัยรัชกาลที่ 7 ที่ถูกทิ้งร้างมานานกว่า 20 ปี</p>
                        <p>เมื่อเจ้าหน้าที่เข้าตรวจสอบ พบศพชายไม่ทราบชื่อ อายุประมาณ 30-40 ปี สวมชุดสูทสีน้ำเงิน สภาพศพเริ่มเน่าเปื่อย คาดว่าเสียชีวิตมาแล้วไม่ต่ำกว่า 3 วัน</p>
                        <h3>พบเบาะแสสำคัญ!</h3>
                        <p>สิ่งที่น่าตกใจคือ บริเวณผนังห้องข้างศพ <i>มีรอยเลือดเขียนเป็นตัวอักษรปริศนาว่า 'REVENGE'</i> และในมือผู้ตายกำ 'กระดุมทองคำ' ที่สลักตราตระกูลดังเอาไว้แน่น</p>
                        <p>พ.ต.ท.วิชัย สารวัตรสอบสวน กล่าวว่า 'คดีนี้มีความซับซ้อนมากกว่าการฆ่าชิงทรัพย์ธรรมดา คนร้ายน่าจะมีความแค้นส่วนตัว หรือเกี่ยวข้องกับความขัดแย้งทางธุรกิจมืด เรากำลังเร่งตรวจสอบกล้องวงจรปิดในพื้นที่ใกล้เคียง'</p>
                        <p style='color:red; font-weight:bold;'>หากใครมีเบาะแส โปรดแจ้งที่สายด่วน 191 หรือ สน.พื้นที่โดยด่วน</p>
                    "
                },

                // ข่าวที่ 2: วิเคราะห์ฆาตกรต่อเนื่อง
                new SearchResult
                {
                    Id = "analysis-serial-killer",
                    Title = "เจาะลึก: 'นักล่าราตรี' ฆาตกรต่อเนื่องที่ยังลอยนวล",
                    Url = "https://www.detective-club.net/cases/serial-killer-update",
                    Snippet = "วิเคราะห์หลักฐานใหม่จากที่เกิดเหตุ พบรอยเลือดที่เป็นปริศนา... และความเชื่อมโยงกับคดีเมื่อ 10 ปีก่อน ที่ตำรวจยังไขไม่ออก",
                    Date = "เมื่อวานนี้",
                    ImageUrl = "https://images.unsplash.com/photo-1588611910663-e3a479901460?q=80&w=800&auto=format&fit=crop", // รูปแฟ้มคดี
                    FullContent = @"
                        <p>คดีฆาตกรรมต่อเนื่องที่สร้างความหวาดผวาให้กับชาวเมืองตลอดเดือนที่ผ่านมา ยังคงเป็นปริศนา เมื่อคนร้ายที่ได้รับฉายาว่า <b>'นักล่าราตรี'</b> ยังคงลอยนวลและก่อเหตุอย่างต่อเนื่อง</p>
                        <p>ล่าสุด ทีมสืบสวนพิเศษได้เปิดเผยข้อมูลที่น่าสนใจว่า เหยื่อทั้ง 3 รายก่อนหน้านี้ ล้วนมีความเกี่ยวข้องกับ <i>'บริษัทอสังหาริมทรัพย์ชื่อดัง'</i> แห่งหนึ่ง</p>
                        <ul>
                            <li>เหยื่อรายที่ 1: เป็นทนายความของบริษัท</li>
                            <li>เหยื่อรายที่ 2: เป็นเลขาหน้าห้องผู้บริหาร</li>
                            <li>เหยื่อรายที่ 3: เป็นผู้รับเหมาที่เคยฟ้องร้องกับบริษัท</li>
                        </ul>
                        <p>ผู้เชี่ยวชาญด้านอาชญาวิทยาตั้งข้อสังเกตว่า คนร้ายอาจไม่ใช่คนโรคจิตทั่วไป แต่เป็นคนที่มีความแค้นฝังหุ่น และมีการวางแผนมาอย่างดีเยี่ยม เพราะในที่เกิดเหตุ <u>ไม่เคยทิ้งลายนิ้วมือไว้เลย</u></p>
                    "
                },

                // ข่าวที่ 3: พยานหายตัว
                new SearchResult
                {
                    Id = "news-missing-witness",
                    Title = "ด่วน! 'ป้าสมร' พยานปากเอกคดีฆ่าเสี่ย หายตัวไปอย่างไร้ร่องรอย",
                    Url = "https://www.news-monitor.co.th/missing-witness",
                    Snippet = "หลังจากการให้ปากคำในคดีฆาตกรรมเศรษฐินี พยานคนสำคัญได้ขาดการติดต่อไป ญาติหวั่นถูกอุ้มฆ่าปิดปาก...",
                    Date = "3 วันที่แล้ว",
                    ImageUrl = "https://images.unsplash.com/photo-1555529733-1463e27976e8?q=80&w=800&auto=format&fit=crop", // รูปป้ายคนหาย
                    FullContent = @"
                        <p>ความคืบหน้าคดีฆาตกรรมเสี่ยเจ้าของโรงงานน้ำแข็ง ล่าสุดเกิดเหตุการณ์ไม่คาดฝันขึ้น เมื่อ <b>นางสมร (สงวนนามสกุล)</b> หรือ 'ป้าสมร' แม่ค้าขายก๋วยเตี๋ยวหน้าปากซอย ซึ่งเป็นพยานเพียงคนเดียวที่เห็นหน้าคนร้าย ได้หายตัวไป</p>
                        <p>ลูกสาวของป้าสมรเปิดเผยทั้งน้ำตาว่า <i>'แม่บอกว่าจะไปสถานีตำรวจเพื่อชี้ตัวคนร้ายเมื่อเช้าวานนี้ แล้วก็ติดต่อไม่ได้อีกเลย โทรศัพท์ก็ปิดเครื่อง'</i></p>
                        <p>ชาวบ้านลือกันหนาหูว่า อาจมี 'คนมีสี' เข้ามาเกี่ยวข้องกับคดีนี้ ทำให้พยานไม่กล้าพูดความจริง หรืออาจถูกสั่งเก็บเพื่อตัดตอนพยานหลักฐาน</p>
                        <p>ขณะนี้ตำรวจกำลังเร่งแกะรอยสัญญาณมือถือครั้งสุดท้าย ซึ่งพบว่าพิกัดอยู่ที่ <b>โกดังร้างริมแม่น้ำ</b> ก่อนสัญญาณจะดับไป</p>
                    "
                },

                // ข่าวที่ 4: ความรู้ (ตัวหลอก)
                new SearchResult
                {
                    Id = "edu-forensics",
                    Title = "วิธีการตรวจสอบ DNA ในที่เกิดเหตุ - Forensics 101",
                    Url = "https://www.science-crime.org/dna-testing",
                    Snippet = "เรียนรู้วิธีการทำงานของนิติวิทยาศาสตร์ในการระบุตัวคนร้ายจากร่องรอยเพียงเล็กน้อย เช่น เส้นผม หรือคราบเหงื่อ...",
                    Date = "10 ต.ค. 2024",
                    ImageUrl = "https://images.unsplash.com/photo-1579154204601-01588f351e67?q=80&w=800&auto=format&fit=crop", // รูปห้องแล็บ
                    FullContent = @"
                        <p>ในคดีอาชญากรรม หลักฐานทางนิติวิทยาศาสตร์ถือเป็นกุญแจสำคัญที่จะมัดตัวคนร้ายได้ดิ้นไม่หลุด วันนี้เราจะพามาดูขั้นตอนการเก็บกู้ DNA</p>
                        <ol>
                            <li><b>การกันพื้นที่:</b> ห้ามผู้ไม่มีส่วนเกี่ยวข้องเข้าเด็ดขาด เพื่อป้องกันการปนเปื้อน</li>
                            <li><b>การเก็บตัวอย่าง:</b> ใช้ไม้พันสำลี (Swab) เก็บจากคราบเลือด น้ำลาย หรือวัตถุพยาน</li>
                            <li><b>การสกัด DNA:</b> นำเข้าห้องปฏิบัติการเพื่อแยกสายพันธุกรรม</li>
                        </ol>
                        <p>รู้หรือไม่? แม้แต่ <i>'ขี้ไคล'</i> เพียงเล็กน้อยที่ติดอยู่ในเล็บของเหยื่อ ก็สามารถระบุตัวฆาตกรได้!</p>
                    "
                }
            };
        }
        // เพิ่มใน Class MockSearchService
        public List<string> GetSuggestions(string query)
        {
            if (string.IsNullOrWhiteSpace(query)) return new List<string>();

            return _allResults
                .Where(x => x.Title.Contains(query, StringComparison.OrdinalIgnoreCase))
                .Select(x => x.Title) // เอาแค่ชื่อเรื่อง
                .Take(5) // เอามาแค่ 5 อันพอ เดี๋ยวรก
                .ToList();
        }
        // ฟังก์ชันค้นหา
        public List<SearchResult> Search(string query)
        {
            if (string.IsNullOrWhiteSpace(query)) return _allResults;

            return _allResults
                .Where(x => x.Title.Contains(query, StringComparison.OrdinalIgnoreCase) ||
                            x.Snippet.Contains(query, StringComparison.OrdinalIgnoreCase))
                .ToList();
        }

        // ฟังก์ชันดึงข่าวตาม ID (ใช้สำหรับหน้า NewsDetail)
        public SearchResult? GetArticle(string id)
        {
            return _allResults.FirstOrDefault(x => x.Id == id);
        }
    }
}
